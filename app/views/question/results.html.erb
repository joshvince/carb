
<% if flash[:newsflash] %>
  <script>
    setTimeout(() => {
      document.cookie = "enspuddification=true;";
      document.dispatchEvent(new Event('enspuddify'));
    }, 2000);
  </script>
<% end %>

<div class="flex flex-col w-screen">
  <div class="sticky top-0 z-10 bg-gradient-to-b from-yellow-50/60 via-yellow-50/40 to-transparent backdrop-blur-sm pb-6 shadow-[0_4px_6px_-1px_rgba(0,0,0,0.1)]">
    <div class="flex flex-col gap-y-2 px-6 md:px-12 py-4 mt-8">
      <h1 class="text-5xl text-amber-900 font-black">The Results</h1>
      <div class="text-xl text-amber-600 font-black">The People have spoken</div>
    </div>
  </div>

  <div class="w-full max-w-2xl mx-auto mt-8 px-6">
    <div class="flex justify-end pb-4">
      <div class="flex items-center gap-x-3">
        <span class="text-sm font-semibold text-amber-700">Corrigan Score</span>
        <button id="toggle-view" class="relative inline-flex h-6 w-11 items-center rounded-full bg-amber-200 transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2" role="switch" aria-checked="false">
          <span class="inline-block h-4 w-4 transform rounded-full bg-white transition duration-200 ease-in-out translate-x-1"></span>
        </button>
        <span class="text-sm font-semibold text-rose-700">Havoc Ratio</span>
      </div>
    </div>
  </div>

  <div id="corrigan-score-section">
    <%= render partial: 'question/corrigan_score', locals: { totals: corrigan_score_view_data(**local_assigns)} %>
  </div>

  <div id="havoc-ratio-section" class="hidden">
    <%= render partial: 'question/weighted_havoc_ratio', locals: { totals: weighted_havoc_ratio_view_data(**local_assigns)} %>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const toggle = document.getElementById('toggle-view');
  const corriganSection = document.getElementById('corrigan-score-section');
  const havocSection = document.getElementById('havoc-ratio-section');

  toggle.addEventListener('click', function() {
    const isChecked = toggle.getAttribute('aria-checked') === 'true';

    if (isChecked) {
      // Switch to Corrigan Score
      toggle.setAttribute('aria-checked', 'false');
      toggle.querySelector('span').classList.remove('translate-x-6');
      toggle.querySelector('span').classList.add('translate-x-1');
      toggle.classList.remove('bg-rose-200');
      toggle.classList.add('bg-amber-200');
      corriganSection.classList.remove('hidden');
      havocSection.classList.add('hidden');
    } else {
      // Switch to Havoc Ratio
      toggle.setAttribute('aria-checked', 'true');
      toggle.querySelector('span').classList.remove('translate-x-1');
      toggle.querySelector('span').classList.add('translate-x-6');
      toggle.classList.remove('bg-amber-200');
      toggle.classList.add('bg-rose-200');
      corriganSection.classList.add('hidden');
      havocSection.classList.remove('hidden');
    }
  });
});
</script>
